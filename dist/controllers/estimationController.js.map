{"version":3,"file":"estimationController.js","sourceRoot":"","sources":["../../src/controllers/estimationController.ts"],"names":[],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","sourcesContent":["import { Request, Response } from \"express\";\r\nimport { asyncHandler } from \"../utils/asyncHandler\";\r\nimport { ApiResponse } from \"../utils/apiHandlerHelpers\";\r\nimport { ApiError } from \"../utils/apiHandlerHelpers\";\r\nimport { Estimation, IEstimation } from \"../models/estimationModel\";\r\nimport { IProject, Project } from \"../models/projectModel\";\r\nimport { Types } from \"mongoose\";\r\nimport puppeteer from \"puppeteer\";\r\nimport { Client, IClient } from \"../models/clientModel\";\r\nimport { Comment } from \"../models/commentModel\";\r\nimport { IUser, User } from \"../models/userModel\";\r\nimport { mailer } from \"../utils/mailer\";\r\nimport { generateRelatedDocumentNumber } from \"../utils/documentNumbers\";\r\nimport { EstimationTemplateParams } from \"@/template/estimationCheckedEmailTemplate\";\r\n\r\nexport const createEstimation = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const {\r\n      project,\r\n      workStartDate,\r\n      workEndDate,\r\n      validUntil,\r\n      paymentDueBy,\r\n      materials,\r\n      labour,\r\n      termsAndConditions,\r\n      quotationAmount,\r\n      commissionAmount,\r\n      subject,\r\n    } = req.body;\r\n\r\n    // Validate required fields\r\n    if (\r\n      !project ||\r\n      !workStartDate ||\r\n      !workEndDate ||\r\n      !validUntil ||\r\n      !paymentDueBy\r\n    ) {\r\n      throw new ApiError(400, \"Required fields are missing\");\r\n    }\r\n\r\n    // Check if an estimation already exists for this project\r\n    const existingEstimation = await Estimation.findOne({ project });\r\n    if (existingEstimation) {\r\n      throw new ApiError(\r\n        400,\r\n        \"Only one estimation is allowed per project. Update the existing estimation instead.\"\r\n      );\r\n    }\r\n\r\n    // Validate materials (now with UOM)\r\n    if (materials && materials.length > 0) {\r\n      for (const item of materials) {\r\n        if (\r\n          !item.description ||\r\n          !item.uom ||\r\n          item.quantity == null ||\r\n          item.unitPrice == null\r\n        ) {\r\n          throw new ApiError(\r\n            400,\r\n            \"Material items require description, uom, quantity, and unitPrice\"\r\n          );\r\n        }\r\n        item.total = item.quantity * item.unitPrice;\r\n      }\r\n    }\r\n\r\n    // Validate labour\r\n    if (labour && labour.length > 0) {\r\n      for (const item of labour) {\r\n        if (!item.designation || item.days == null || item.price == null) {\r\n          throw new ApiError(\r\n            400,\r\n            \"Labour items require designation, days, and price\"\r\n          );\r\n        }\r\n        item.total = item.days * item.price;\r\n      }\r\n    }\r\n\r\n    // Validate terms (now with UOM)\r\n    if (termsAndConditions && termsAndConditions.length > 0) {\r\n      for (const item of termsAndConditions) {\r\n        if (\r\n          !item.description ||\r\n          item.quantity == null ||\r\n          item.unitPrice == null\r\n        ) {\r\n          throw new ApiError(\r\n            400,\r\n            \"Terms items require description, uom, quantity, and unitPrice\"\r\n          );\r\n        }\r\n        item.total = item.quantity * item.unitPrice;\r\n      }\r\n    }\r\n\r\n    // At least one item is required\r\n    if (\r\n      (!materials || materials.length === 0) &&\r\n      (!labour || labour.length === 0) &&\r\n      (!termsAndConditions || termsAndConditions.length === 0)\r\n    ) {\r\n      throw new ApiError(\r\n        400,\r\n        \"At least one item (materials, labour, or terms) is required\"\r\n      );\r\n    }\r\n\r\n    const estimation = await Estimation.create({\r\n      project,\r\n      estimationNumber: await generateRelatedDocumentNumber(project, \"EST\"),\r\n      workStartDate: new Date(workStartDate),\r\n      workEndDate: new Date(workEndDate),\r\n      validUntil: new Date(validUntil),\r\n      paymentDueBy,\r\n      materials: materials || [],\r\n      labour: labour || [],\r\n      termsAndConditions: termsAndConditions || [],\r\n      quotationAmount,\r\n      commissionAmount,\r\n      preparedBy: req.user?.userId,\r\n      subject: subject,\r\n    });\r\n\r\n    await Project.findByIdAndUpdate(project, {\r\n      status: \"estimation_prepared\",\r\n    });\r\n\r\n    res\r\n      .status(201)\r\n      .json(\r\n        new ApiResponse(201, estimation, \"Estimation created successfully\")\r\n      );\r\n  }\r\n);\r\n\r\nexport const approveEstimation = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { id } = req.params;\r\n    const { comment, isApproved } = req.body;\r\n    const userId = req.user?.userId;\r\n\r\n    // Validate input\r\n    if (!userId) throw new ApiError(401, \"Unauthorized\");\r\n    if (typeof isApproved !== \"boolean\") {\r\n      throw new ApiError(400, \"isApproved must be a boolean\");\r\n    }\r\n\r\n    // Convert userId to ObjectId\r\n    const userIdObject = new Types.ObjectId(userId);\r\n\r\n    // Define populated types\r\n    type PopulatedEstimation = Omit<IEstimation, \"project\"> & {\r\n      project: IProject;\r\n    };\r\n\r\n    type PopulatedProject = Omit<IProject, \"assignedTo\"> & {\r\n      assignedTo?: {\r\n        _id: Types.ObjectId;\r\n        email?: string;\r\n        firstName?: string;\r\n        lastName?: string;\r\n      };\r\n    };\r\n\r\n    const estimation = await Estimation.findById(id).populate<{\r\n      project: IProject;\r\n    }>(\"project\");\r\n    if (!estimation) throw new ApiError(404, \"Estimation not found\");\r\n\r\n    // Check prerequisites\r\n    if (!estimation.isChecked) {\r\n      throw new ApiError(\r\n        400,\r\n        \"Estimation must be checked before approval/rejection\"\r\n      );\r\n    }\r\n    if (estimation.isApproved && isApproved) {\r\n      throw new ApiError(400, \"Estimation is already approved\");\r\n    }\r\n\r\n    // Create activity log\r\n    await Comment.create({\r\n      content: comment || `Estimation ${isApproved ? \"approved\" : \"rejected\"}`,\r\n      user: userIdObject,\r\n      project: estimation.project,\r\n      actionType: isApproved ? \"approval\" : \"rejection\",\r\n    });\r\n\r\n    // Update estimation\r\n    estimation.isApproved = isApproved;\r\n    estimation.approvedBy = isApproved ? userIdObject : undefined;\r\n    estimation.approvalComment = comment;\r\n    await estimation.save();\r\n\r\n    // Update project status\r\n    await Project.findByIdAndUpdate(estimation.project, {\r\n      status: isApproved ? \"quotation_approved\" : \"quotation_rejected\",\r\n      updatedBy: userIdObject,\r\n    });\r\n\r\n    try {\r\n      // Get all recipients (assigned engineer + admins + super_admins)\r\n      const project = await Project.findById(estimation.project).populate<{\r\n        assignedTo: Pick<IUser, \"_id\" | \"email\" | \"firstName\" | \"lastName\">;\r\n      }>(\"assignedTo\", \"email firstName lastName\");\r\n\r\n      const assignedEngineer = project?.assignedTo;\r\n\r\n      const admins = await User.find({\r\n        role: { $in: [\"admin\", \"super_admin\"] },\r\n        email: { $exists: true, $ne: \"\" },\r\n      });\r\n\r\n      // Get the user who performed the approval\r\n      const approver = await User.findById(userIdObject);\r\n\r\n      // Prepare recipient list\r\n      const recipients = [];\r\n\r\n      // Add assigned engineer if exists\r\n      if (assignedEngineer?.email) {\r\n        recipients.push({\r\n          email: assignedEngineer.email,\r\n          name: assignedEngineer.firstName || \"Engineer\",\r\n        });\r\n      }\r\n\r\n      // Add admins and super admins\r\n      admins.forEach((admin) => {\r\n        recipients.push({\r\n          email: admin.email,\r\n          name: admin.firstName || \"Admin\",\r\n        });\r\n      });\r\n\r\n      // Remove duplicates\r\n      const uniqueRecipients = recipients.filter(\r\n        (recipient, index, self) =>\r\n          index === self.findIndex((r) => r.email === recipient.email)\r\n      );\r\n\r\n      // Prepare email content\r\n      const templateParams: EstimationTemplateParams = {\r\n        userName: \"Team\",\r\n        actionUrl: `http://localhost:5173/app/project-view/${estimation.project._id}`,\r\n        contactEmail: \"propertymanagement@alhamra.ae\",\r\n        logoUrl:\r\n          \"https://krishnadas-test-1.s3.ap-south-1.amazonaws.com/alghazal/logo+alghazal.png\",\r\n        estimationNumber: estimation.estimationNumber,\r\n        checkerName: approver\r\n          ? `${approver.firstName} ${approver.lastName}`\r\n          : \"an approver\",\r\n        projectName: estimation.project.projectName || \"the project\",\r\n        dueDate: estimation.validUntil?.toLocaleDateString(),\r\n      };\r\n\r\n      // Send email to all recipients\r\n      await mailer.sendEmail({\r\n        to: process.env.NOTIFICATION_INBOX || \"notifications@company.com\",\r\n        bcc: uniqueRecipients.map((r) => r.email).join(\",\"),\r\n        subject: `Estimation ${isApproved ? \"Approved\" : \"Rejected\"}: ${\r\n          estimation.estimationNumber\r\n        }`,\r\n        templateParams: templateParams, // Just pass the templateParams without content\r\n        text: `Dear Team,\\n\\nEstimation ${\r\n          estimation.estimationNumber\r\n        } for project ${templateParams.projectName} has been ${\r\n          isApproved ? \"approved\" : \"rejected\"\r\n        } by ${templateParams.checkerName}.\\n\\nView project: ${\r\n          templateParams.actionUrl\r\n        }\\n\\nBest regards,\\nTECHNICAL SERVICE TEAM`,\r\n        headers: {\r\n          \"X-Priority\": \"1\",\r\n          Importance: \"high\",\r\n        },\r\n      });\r\n    } catch (emailError) {\r\n      console.error(\"Failed to send notification emails:\", emailError);\r\n      // Continue even if email fails\r\n    }\r\n\r\n    res\r\n      .status(200)\r\n      .json(\r\n        new ApiResponse(\r\n          200,\r\n          estimation,\r\n          `Estimation ${isApproved ? \"approved\" : \"rejected\"} successfully`\r\n        )\r\n      );\r\n  }\r\n);\r\n\r\nexport const markAsChecked = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { id } = req.params;\r\n    const { comment, isChecked } = req.body;\r\n    const userId = req.user?.userId;\r\n\r\n    // Validate input\r\n    if (!userId) throw new ApiError(401, \"Unauthorized\");\r\n    if (typeof isChecked !== \"boolean\") {\r\n      throw new ApiError(400, \"isChecked must be a boolean\");\r\n    }\r\n\r\n    const estimation = await Estimation.findById(id).populate(\"project\");\r\n    if (!estimation) throw new ApiError(404, \"Estimation not found\");\r\n\r\n    // Check prerequisites\r\n    if (estimation.isChecked && isChecked) {\r\n      throw new ApiError(400, \"Estimation is already checked\");\r\n    }\r\n\r\n    // Convert userId to ObjectId\r\n    const userIdObject = new Types.ObjectId(userId);\r\n\r\n    // Create activity log\r\n    await Comment.create({\r\n      content:\r\n        comment ||\r\n        `Estimation ${isChecked ? \"checked\" : \"rejected during check\"}`,\r\n      user: userIdObject,\r\n      project: estimation.project,\r\n      actionType: isChecked ? \"check\" : \"rejection\",\r\n    });\r\n\r\n    // Update estimation\r\n    estimation.isChecked = isChecked;\r\n    estimation.checkedBy = isChecked ? userIdObject : undefined;\r\n    if (comment) estimation.approvalComment = comment;\r\n    await estimation.save();\r\n\r\n    // Update project status if rejected\r\n    if (!isChecked) {\r\n      await Project.findByIdAndUpdate(estimation.project, {\r\n        status: \"draft\",\r\n        updatedBy: userIdObject,\r\n      });\r\n    }\r\n\r\n    // Send email to admins if checked\r\n    if (isChecked) {\r\n      try {\r\n        // Find all admin and super_admin users\r\n        const admins = await User.find({\r\n          role: { $in: [\"admin\", \"super_admin\"] },\r\n          email: { $exists: true, $ne: \"\" },\r\n        });\r\n\r\n        // Get the user who performed the check\r\n        const checkedByUser = await User.findById(userIdObject);\r\n\r\n        // Prepare common email content\r\n        const project = estimation.project as any;\r\n        const templateParams: EstimationTemplateParams = {\r\n          userName: \"Team\",\r\n          actionUrl: `http://localhost:5173/app/project-view/${estimation.project._id}`,\r\n          contactEmail: \"propertymanagement@alhamra.ae\",\r\n          logoUrl:\r\n            \"https://krishnadas-test-1.s3.ap-south-1.amazonaws.com/alghazal/logo+alghazal.png\",\r\n          estimationNumber: estimation.estimationNumber,\r\n          checkerName: checkedByUser\r\n            ? `${checkedByUser.firstName} ${checkedByUser.lastName}`\r\n            : \"a team member\",\r\n          projectName: project?.projectName || \"the project\",\r\n          dueDate: estimation.validUntil?.toLocaleDateString(),\r\n        };\r\n\r\n        // Send single email to all admins (BCC to hide recipient list)\r\n        await mailer.sendEmail({\r\n          to: process.env.NOTIFICATION_INBOX || \"notifications@company.com\",\r\n          bcc: admins.map((admin) => admin.email).join(\",\"),\r\n          subject: `Estimation Checked: ${estimation.estimationNumber}`,\r\n          templateParams,\r\n          text: `Dear Team,\\n\\nEstimation ${estimation.estimationNumber} for project ${templateParams.projectName} has been checked by ${templateParams.checkerName}.\\n\\nView project: ${templateParams.actionUrl}\\n\\nBest regards,\\nTECHNICAL SERVICE TEAM`,\r\n          headers: {\r\n            \"X-Priority\": \"1\",\r\n            Importance: \"high\",\r\n          },\r\n        });\r\n      } catch (emailError) {\r\n        console.error(\"Failed to send notification emails:\", emailError);\r\n        // Continue even if email fails\r\n      }\r\n    }\r\n\r\n    res\r\n      .status(200)\r\n      .json(\r\n        new ApiResponse(\r\n          200,\r\n          estimation,\r\n          `Estimation ${isChecked ? \"checked\" : \"rejected\"} successfully`\r\n        )\r\n      );\r\n  }\r\n);\r\nexport const getEstimationsByProject = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { projectId } = req.params;\r\n    const { status } = req.query;\r\n\r\n    const filter: any = { project: projectId };\r\n    if (status === \"checked\") filter.isChecked = true;\r\n    if (status === \"approved\") filter.isApproved = true;\r\n    if (status === \"pending\") filter.isChecked = false;\r\n\r\n    const estimations = await Estimation.find(filter)\r\n      .populate(\"preparedBy\", \"firstName lastName\")\r\n      .populate(\"checkedBy\", \"firstName lastName\")\r\n      .populate(\"approvedBy\", \"firstName lastName\")\r\n      .sort({ createdAt: -1 });\r\n\r\n    res\r\n      .status(200)\r\n      .json(\r\n        new ApiResponse(200, estimations, \"Estimations retrieved successfully\")\r\n      );\r\n  }\r\n);\r\n\r\nexport const getEstimationDetails = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { id } = req.params;\r\n\r\n    // Define types for populated fields\r\n    type PopulatedEstimation = Omit<\r\n      IEstimation,\r\n      \"project\" | \"preparedBy\" | \"checkedBy\" | \"approvedBy\"\r\n    > & {\r\n      project: {\r\n        _id: Types.ObjectId;\r\n        projectName: string;\r\n        client: Types.ObjectId | IClient;\r\n      };\r\n      preparedBy?: {\r\n        _id: Types.ObjectId;\r\n        firstName: string;\r\n        lastName: string;\r\n      };\r\n      checkedBy?: {\r\n        _id: Types.ObjectId;\r\n        firstName: string;\r\n        lastName: string;\r\n      };\r\n      approvedBy?: {\r\n        _id: Types.ObjectId;\r\n        firstName: string;\r\n        lastName: string;\r\n      };\r\n    };\r\n\r\n    const estimationE = await Estimation.findById(id)\r\n      .populate<{\r\n        project: { projectName: string; client: Types.ObjectId | IClient };\r\n      }>(\"project\", \"projectName client\")\r\n      .populate<{ preparedBy: { firstName: string; lastName: string } }>(\r\n        \"preparedBy\",\r\n        \"firstName lastName\"\r\n      )\r\n      .populate<{ checkedBy: { firstName: string; lastName: string } }>(\r\n        \"checkedBy\",\r\n        \"firstName lastName\"\r\n      )\r\n      .populate<{ approvedBy: { firstName: string; lastName: string } }>(\r\n        \"approvedBy\",\r\n        \"firstName lastName\"\r\n      );\r\n\r\n    if (!estimationE) {\r\n      throw new ApiError(404, \"Estimation not found\");\r\n    }\r\n\r\n    // Type assertion for the populated estimation\r\n    const populatedEstimation = estimationE as unknown as PopulatedEstimation &\r\n      Document;\r\n\r\n    // Get client ID safely\r\n    const clientId = populatedEstimation.project?.client;\r\n    if (!clientId) {\r\n      throw new ApiError(400, \"Client information not found\");\r\n    }\r\n\r\n    const client = await Client.findById(clientId);\r\n\r\n    // Prepare response object maintaining the same structure as before\r\n    const estimation = {\r\n      ...populatedEstimation.toObject(), // Using toObject() instead of _doc\r\n      client,\r\n    };\r\n\r\n    res\r\n      .status(200)\r\n      .json(new ApiResponse(200, estimation, \"Estimation details retrieved\"));\r\n  }\r\n);\r\n\r\nexport const updateEstimation = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { id } = req.params;\r\n    const updateData = req.body;\r\n    console.log(req.body);\r\n    const estimation = await Estimation.findById(id);\r\n    if (!estimation) {\r\n      throw new ApiError(404, \"Estimation not found\");\r\n    }\r\n\r\n    if (estimation.isApproved) {\r\n      throw new ApiError(400, \"Cannot update approved estimation\");\r\n    }\r\n\r\n    // Reset checked status if updating\r\n    if (estimation.isChecked) {\r\n      estimation.isChecked = false;\r\n      estimation.checkedBy = undefined;\r\n      estimation.approvalComment = undefined;\r\n    }\r\n\r\n    // Don't allow changing these fields directly\r\n    delete updateData.isApproved;\r\n    delete updateData.approvedBy;\r\n    delete updateData.estimatedAmount;\r\n    delete updateData.profit;\r\n\r\n    // Update materials with UOM if present\r\n    if (updateData.materials) {\r\n      for (const item of updateData.materials) {\r\n        if (!item.uom) {\r\n          throw new ApiError(400, \"UOM is required for material items\");\r\n        }\r\n        if (item.quantity && item.unitPrice) {\r\n          item.total = item.quantity * item.unitPrice;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Update labour if present\r\n    if (updateData.labour) {\r\n      for (const item of updateData.labour) {\r\n        if (item.days && item.price) {\r\n          item.total = item.days * item.price;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Update fields\r\n    estimation.set(updateData);\r\n    await estimation.save();\r\n\r\n    res\r\n      .status(200)\r\n      .json(\r\n        new ApiResponse(200, estimation, \"Estimation updated successfully\")\r\n      );\r\n  }\r\n);\r\n\r\nexport const deleteEstimation = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { id } = req.params;\r\n\r\n    const estimation = await Estimation.findById(id);\r\n    if (!estimation) {\r\n      throw new ApiError(404, \"Estimation not found\");\r\n    }\r\n\r\n    if (estimation.isApproved) {\r\n      throw new ApiError(400, \"Cannot delete approved estimation\");\r\n    }\r\n\r\n    await Estimation.findByIdAndDelete(id);\r\n\r\n    res\r\n      .status(200)\r\n      .json(new ApiResponse(200, null, \"Estimation deleted successfully\"));\r\n  }\r\n);\r\n\r\ninterface PopulatedEstimationItem {\r\n  description: string;\r\n  uom: string;\r\n  quantity: number;\r\n  unitPrice: number;\r\n  total: number;\r\n}\r\n\r\ninterface PopulatedLabourItem {\r\n  designation: string;\r\n  days: number;\r\n  price: number;\r\n  total: number;\r\n}\r\n\r\ninterface PopulatedTermsItem {\r\n  description: string;\r\n  quantity: number;\r\n  unitPrice: number;\r\n  total: number;\r\n}\r\n\r\ninterface PopulatedClient {\r\n  _id: string;\r\n  clientName: string;\r\n  clientAddress: string;\r\n  email: string;\r\n  mobileNumber: string;\r\n  telephoneNumber: string;\r\n}\r\n\r\ninterface PopulatedProject {\r\n  _id: string;\r\n  projectName: string;\r\n  client: PopulatedClient;\r\n  location: string;\r\n  building: string;\r\n  apartmentNumber: string;\r\n}\r\n\r\ninterface PopulatedEstimation extends Document {\r\n  project: PopulatedProject;\r\n  estimationNumber: string;\r\n  workStartDate: Date;\r\n  workEndDate: Date;\r\n  validUntil: Date;\r\n  paymentDueBy: number;\r\n  subject?: string;\r\n  materials: PopulatedEstimationItem[];\r\n  labour: PopulatedLabourItem[];\r\n  termsAndConditions: PopulatedTermsItem[];\r\n  estimatedAmount: number;\r\n  quotationAmount?: number;\r\n  commissionAmount?: number;\r\n  profit?: number;\r\n  preparedBy: Pick<IUser, \"firstName\" | \"signatureImage\"> | Types.ObjectId;\r\n  checkedBy?: Pick<IUser, \"firstName\" | \"signatureImage\"> | Types.ObjectId;\r\n  approvedBy?: Pick<IUser, \"firstName\" | \"signatureImage\"> | Types.ObjectId;\r\n  isChecked: boolean;\r\n  isApproved: boolean;\r\n  approvalComment?: string;\r\n  createdAt: Date;\r\n  updatedAt: Date;\r\n}\r\n\r\nexport const generateEstimationPdf = asyncHandler(\r\n  async (req: Request, res: Response) => {\r\n    const { id } = req.params;\r\n\r\n    const estimation = await Estimation.findById(id)\r\n      .populate<PopulatedEstimation>({\r\n        path: \"project\",\r\n        select: \"projectName client location building apartmentNumber\",\r\n        populate: {\r\n          path: \"client\",\r\n          select: \"clientName clientAddress email mobileNumber telephoneNumber\",\r\n        },\r\n      })\r\n      .populate(\"preparedBy\", \"firstName signatureImage\")\r\n      .populate(\"checkedBy\", \"firstName signatureImage\")\r\n      .populate(\"approvedBy\", \"firstName signatureImage\");\r\n\r\n    if (!estimation) {\r\n      throw new ApiError(404, \"Estimation not found\");\r\n    }\r\n\r\n    // Verify populated data exists\r\n    if (!estimation.project || !estimation.project.client) {\r\n      throw new ApiError(400, \"Client information not found\");\r\n    }\r\n\r\n    // Type guard to check if populated fields are IUser objects\r\n    const isPopulatedUser = (\r\n      user: any\r\n    ): user is Pick<IUser, \"firstName\" | \"signatureImage\"> => {\r\n      return user && typeof user === \"object\" && \"firstName\" in user;\r\n    };\r\n\r\n    // Get user data with proper typing\r\n    const preparedBy = isPopulatedUser(estimation.preparedBy)\r\n      ? estimation.preparedBy\r\n      : null;\r\n    const checkedBy = isPopulatedUser(estimation.checkedBy)\r\n      ? estimation.checkedBy\r\n      : null;\r\n    const approvedBy = isPopulatedUser(estimation.approvedBy)\r\n      ? estimation.approvedBy\r\n      : null;\r\n\r\n    // Calculate totals\r\n    const materialsTotal = estimation.materials.reduce(\r\n      (sum, item) => sum + item.total,\r\n      0\r\n    );\r\n    const labourTotal = estimation.labour.reduce(\r\n      (sum, item) => sum + item.total,\r\n      0\r\n    );\r\n    const termsTotal = estimation.termsAndConditions.reduce(\r\n      (sum, item) => sum + item.total,\r\n      0\r\n    );\r\n    const estimatedAmount = materialsTotal + labourTotal + termsTotal;\r\n\r\n    // Format dates\r\n    const formatDate = (date?: Date) => {\r\n      return date ? new Date(date).toLocaleDateString(\"en-GB\") : \"\";\r\n    };\r\n    // const approvedBy = estimation.approvedBy;\r\n    // const checkedBy = estimation.checkedBy;\r\n    // const preparedBy = estimation.preparedBy;\r\n\r\n    // Prepare HTML content\r\n    let htmlContent = `\r\n    <!DOCTYPE html>\r\n    <html>\r\n     <head>\r\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\r\n    <meta\r\n      name=\"\"\r\n      content=\"\"\r\n    />\r\n    <meta name=\"\" content=\"\" />\r\n    <style type=\"text/css\">\r\n      html {\r\n        font-family: Calibri, Arial, Helvetica, sans-serif;\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      a.comment-indicator:hover + div.comment {\r\n        background: #ffd;\r\n        position: absolute;\r\n        display: block;\r\n        border: 1px solid black;\r\n        padding: 0.5em;\r\n      }\r\n      a.comment-indicator {\r\n        background: red;\r\n        display: inline-block;\r\n        border: 1px solid black;\r\n        width: 0.5em;\r\n        height: 0.5em;\r\n      }\r\n      td{\r\n        padding-left: 10px;\r\n      }\r\n      div.comment {\r\n        display: none;\r\n      }\r\n      table {\r\n        border-collapse: collapse;\r\n        page-break-after: always;\r\n      }\r\n      .gridlines td {\r\n        border: 1px dotted black;\r\n      }\r\n      .gridlines th {\r\n        border: 1px dotted black;\r\n      }\r\n      .b {\r\n        text-align: center;\r\n      }\r\n      .e {\r\n        text-align: center;\r\n      }\r\n      .f {\r\n        text-align: right;\r\n      }\r\n      .inlineStr {\r\n        text-align: left;\r\n      }\r\n      .n {\r\n        text-align: right;\r\n      }\r\n      .s {\r\n        text-align: left;\r\n      }\r\n      td.style0 {\r\n        vertical-align: bottom;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      th.style0 {\r\n        vertical-align: bottom;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      td.style1 {\r\n        vertical-align: bottom;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style1 {\r\n        vertical-align: bottom;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style2 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #bfbfbf !important;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style2 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #bfbfbf !important;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style3 {\r\n        vertical-align: bottom;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style3 {\r\n        vertical-align: bottom;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style4 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #bfbfbf !important;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style4 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #bfbfbf !important;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style5 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #bfbfbf !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style5 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #bfbfbf !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style6 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style6 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style7 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 9px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style7 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 9px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style8 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style8 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style9 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style9 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style10 {\r\n        vertical-align: bottom;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style10 {\r\n        vertical-align: bottom;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style11 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #bfbfbf !important;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style11 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #bfbfbf !important;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style12 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #bfbfbf !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style12 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #bfbfbf !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style13 {\r\n        vertical-align: middle;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style13 {\r\n        vertical-align: middle;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style14 {\r\n        vertical-align: middle;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style14 {\r\n        vertical-align: middle;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style15 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style15 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style16 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style16 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style17 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style17 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style18 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style18 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style19 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style19 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style20 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style20 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style21 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style21 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style22 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style22 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style23 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style23 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style24 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style24 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style25 {\r\n        vertical-align: middle;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style25 {\r\n        vertical-align: middle;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style26 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style26 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style27 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style27 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style28 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style28 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style29 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style29 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style30 {\r\n        vertical-align: middle;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style30 {\r\n        vertical-align: middle;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style31 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style31 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style32 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      th.style32 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      td.style33 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #ffff00;\r\n      }\r\n      th.style33 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #ffff00;\r\n      }\r\n      td.style34 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style34 {\r\n        vertical-align: middle;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style35 {\r\n        vertical-align: middle;\r\n        text-align: right;\r\n        padding-right: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #7f7f7f;\r\n      }\r\n      th.style35 {\r\n        vertical-align: middle;\r\n        text-align: right;\r\n        padding-right: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #7f7f7f;\r\n      }\r\n      td.style36 {\r\n        vertical-align: middle;\r\n        text-align: right;\r\n        padding-right: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #7f7f7f;\r\n      }\r\n      th.style36 {\r\n        vertical-align: middle;\r\n        text-align: right;\r\n        padding-right: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #7f7f7f;\r\n      }\r\n      td.style37 {\r\n        vertical-align: middle;\r\n        text-align: right;\r\n        padding-right: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #7f7f7f;\r\n      }\r\n      th.style37 {\r\n        vertical-align: middle;\r\n        text-align: right;\r\n        padding-right: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #ffffff;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: #7f7f7f;\r\n      }\r\n      td.style38 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style38 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style39 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style39 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style40 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style40 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style41 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style41 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style42 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style42 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style43 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style43 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style44 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style44 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style45 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style45 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style46 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style46 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style47 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style47 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style48 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style48 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a3041;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style49 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style49 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style50 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style50 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style51 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #d8d8d8;\r\n        font-family: 'Century Gothic';\r\n        font-size: 28pt;\r\n        background-color: white;\r\n      }\r\n      th.style51 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #d8d8d8;\r\n        font-family: 'Century Gothic';\r\n        font-size: 28pt;\r\n        background-color: white;\r\n      }\r\n      td.style52 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #d8d8d8;\r\n        font-family: 'Century Gothic';\r\n        font-size: 28pt;\r\n        background-color: white;\r\n      }\r\n      th.style52 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #d8d8d8;\r\n        font-family: 'Century Gothic';\r\n        font-size: 28pt;\r\n        background-color: white;\r\n      }\r\n      td.style53 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #d8d8d8;\r\n        font-family: 'Century Gothic';\r\n        font-size: 28pt;\r\n        background-color: white;\r\n      }\r\n      th.style53 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #d8d8d8;\r\n        font-family: 'Century Gothic';\r\n        font-size: 28pt;\r\n        background-color: white;\r\n      }\r\n      td.style54 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Cambria';\r\n        font-size: 18pt;\r\n        background-color: white;\r\n      }\r\n      th.style54 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Cambria';\r\n        font-size: 18pt;\r\n        background-color: white;\r\n      }\r\n      td.style55 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Cambria';\r\n        font-size: 18pt;\r\n        background-color: white;\r\n      }\r\n      th.style55 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Cambria';\r\n        font-size: 18pt;\r\n        background-color: white;\r\n      }\r\n      td.style56 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Cambria';\r\n        font-size: 18pt;\r\n        background-color: white;\r\n      }\r\n      th.style56 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Cambria';\r\n        font-size: 18pt;\r\n        background-color: white;\r\n      }\r\n      td.style57 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style57 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style58 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style58 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style59 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style59 {\r\n        vertical-align: middle;\r\n        text-align: left;\r\n        padding-left: 0px;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style60 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style60 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style61 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style61 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style62 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style62 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: 2px solid #000000 !important;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style63 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style63 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 1px solid #000000 !important;\r\n        border-right: 2px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #000000;\r\n        font-family: 'Aptos Narrow';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style64 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style64 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style65 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style65 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style66 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style66 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 2px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style67 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style67 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style68 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style68 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: none #000000;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style69 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      th.style69 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: none #000000;\r\n        border-right: 1px solid #000000 !important;\r\n        font-weight: bold;\r\n        color: #0a1e30;\r\n        font-family: 'Times New Roman';\r\n        font-size: 12pt;\r\n        background-color: white;\r\n      }\r\n      td.style70 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      th.style70 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: 1px solid #000000 !important;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      td.style71 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      th.style71 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: none #000000;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      td.style72 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n\r\n      th.style72 {\r\n        vertical-align: middle;\r\n        text-align: center;\r\n        border-bottom: 1px solid #000000 !important;\r\n        border-top: none #000000;\r\n        border-left: 2px solid #000000 !important;\r\n        border-right: 1px solid #000000 !important;\r\n        color: #000000;\r\n        font-family: 'Times New Roman';\r\n        font-size: 11pt;\r\n        background-color: white;\r\n      }\r\n      table.sheet0 col.col0 {\r\n        width: 8.13333324pt;\r\n      }\r\n      table.sheet0 col.col1 {\r\n        width: 170.12222027pt;\r\n      }\r\n      table.sheet0 col.col2 {\r\n        width: 126.74444299pt;\r\n      }\r\n      table.sheet0 col.col3 {\r\n        width: 93.53333226pt;\r\n      }\r\n      table.sheet0 col.col4 {\r\n        width: 80.65555463pt;\r\n      }\r\n      table.sheet0 col.col5 {\r\n        width: 94.21111003pt;\r\n      }\r\n      table.sheet0 tr {\r\n        height: 15pt;\r\n      }\r\n      table.sheet0 tr.row0 {\r\n        height: 15.75pt;\r\n      }\r\n      table.sheet0 tr.row1 {\r\n        height: 123pt;\r\n      }\r\n      table.sheet0 tr.row2 {\r\n        height: 25.5pt;\r\n      }\r\n      table.sheet0 tr.row3 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row4 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row5 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row6 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row7 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row8 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row9 {\r\n        height: 27pt;\r\n      }\r\n      table.sheet0 tr.row10 {\r\n        height: 28.5pt;\r\n      }\r\n      table.sheet0 tr.row11 {\r\n        height: 21pt;\r\n      }\r\n      table.sheet0 tr.row12 {\r\n        height: 21pt;\r\n      }\r\n      table.sheet0 tr.row13 {\r\n        height: 21pt;\r\n      }\r\n      table.sheet0 tr.row14 {\r\n        height: 21pt;\r\n      }\r\n      table.sheet0 tr.row15 {\r\n        height: 21pt;\r\n      }\r\n      table.sheet0 tr.row16 {\r\n        height: 22.5pt;\r\n      }\r\n      table.sheet0 tr.row17 {\r\n        height: 12.75pt;\r\n      }\r\n      table.sheet0 tr.row18 {\r\n        height: 33.75pt;\r\n      }\r\n      table.sheet0 tr.row19 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row20 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row21 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row22 {\r\n        height: 33.75pt;\r\n      }\r\n      table.sheet0 tr.row23 {\r\n        height: 26.25pt;\r\n      }\r\n      table.sheet0 tr.row24 {\r\n        height: 33.75pt;\r\n      }\r\n      table.sheet0 tr.row25 {\r\n        height: 33.75pt;\r\n      }\r\n      table.sheet0 tr.row26 {\r\n        height: 33.75pt;\r\n      }\r\n      table.sheet0 tr.row27 {\r\n        height: 33.75pt;\r\n      }\r\n      table.sheet0 tr.row28 {\r\n        height: 28.5pt;\r\n      }\r\n      table.sheet0 tr.row29 {\r\n        height: 42.75pt;\r\n      }\r\n    </style>\r\n  </head>\r\n      <body>\r\n  <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" id=\"sheet0\" class=\"sheet0 gridlines\" style=\"width: 50%; margin: 0 auto\">\r\n    <col class=\"col0\" />\r\n    <col class=\"col1\" />\r\n    <col class=\"col2\" />\r\n    <col class=\"col3\" />\r\n    <col class=\"col4\" />\r\n    <col class=\"col5\" />\r\n    <tbody>\r\n      <tr class=\"row1\">\r\n        <td class=\"column1 style51 null style53\" colspan=\"5\">\r\n          <div style=\"position: relative\">\r\n            <img\r\n              style=\"z-index: 1; left: 1px; top: 6px; width: 929px; height: 155px;\"\r\n              src=\"https://krishnadas-test-1.s3.ap-south-1.amazonaws.com/alghazal/logo.png\"\r\n              border=\"0\"\r\n            />\r\n          </div>\r\n        </td>\r\n      </tr>\r\n      <tr class=\"row2\">\r\n        <td class=\"column1 style54 s style56\" colspan=\"5\">ESTIMATION</td>\r\n      </tr>\r\n      <tr class=\"row3\">\r\n        <td class=\"column1 style49 s style50\" colspan=\"2\" style=\"padding-left: 10px;\">${\r\n          estimation.project.client.clientName\r\n        }</td>\r\n        <td class=\"column3 style10 s\">DATE</td>\r\n        <td class=\"column4 style10 null\"></td>\r\n        <td class=\"column5 style10 null\"></td>\r\n      </tr>\r\n      <tr class=\"row4\">\r\n        <td class=\"column1 style41 s style42\" colspan=\"2\" style=\"padding-left: 10px;\">${\r\n          estimation.project.client.clientAddress\r\n        }</td>\r\n        <td class=\"column3 style11 s\">OF ESTIMATION</td>\r\n        <td class=\"column4 style11 null\"></td>\r\n        <td class=\"column5 style11 null\"></td>\r\n      </tr>\r\n      <tr class=\"row5\">\r\n        <td class=\"column1 style41 s style42\" colspan=\"2\" style=\"padding-left: 10px;\">\r\n          ${estimation.project.location} ,  ${estimation.project.building} ,  ${\r\n      estimation.project.apartmentNumber\r\n    } \r\n        </td>\r\n        <td class=\"column3 style12 s\">${formatDate(new Date())}</td>\r\n        <td class=\"column4 style12 null\"></td>\r\n        <td class=\"column5 style12 null\"></td>\r\n      </tr>\r\n      <tr class=\"row6\">\r\n                <td class=\"column1 style41 s style42\" colspan=\"2\" style=\"padding-left: 10px;\">\r\n${estimation.project.client.email} , ${\r\n      estimation.project.client.mobileNumber\r\n    } , ${estimation.project.client.telephoneNumber}</td>\r\n        <td class=\"column3 style1 s\">ESTIMATION</td>\r\n        <td class=\"column4 style3 null\"></td>\r\n        <td class=\"column5 style10 s\">PAYMENT</td>\r\n      </tr>\r\n      <tr class=\"row7\">\r\n        <td class=\"column1 style41 s style42\" colspan=\"2\" rowspan=\"2\" style=\"padding-left: 10px;\">\r\n          ${estimation.subject}\r\n        </td>\r\n        <td class=\"column3 style2 s\">NUMBER</td>\r\n        <td class=\"column4 style4 null\"></td>\r\n        <td class=\"column5 style11 s\">DUE BY</td>\r\n      </tr>\r\n      <tr class=\"row8\">\r\n        <td class=\"column3 style5 s\">${estimation.estimationNumber}</td>\r\n        <td class=\"column4 style5 null\"></td>\r\n        <td class=\"column5 style12 s\">${estimation.paymentDueBy} Days</td>\r\n      </tr>\r\n      <tr class=\"row9\">\r\n        <td class=\"column1 style13 null\"></td>\r\n        <td class=\"column2 style25 null\"></td>\r\n        <td class=\"column3 style25 null\"></td>\r\n        <td class=\"column4 style25 null\"></td>\r\n        <td class=\"column5 style14 null\"></td>\r\n      </tr>\r\n\r\n      <!-- Materials section -->\r\n      <tr class=\"row10\">\r\n        <td class=\"column2 style6 s\">MATERIAL</td>\r\n        <td class=\"column5 style16 s\">UOM</td>\r\n        <td class=\"column3 style6 s\">QTY</td>\r\n        <td class=\"column4 style22 s\">UNIT PRICE</td>\r\n        <td class=\"column5 style16 s\">TOTAL</td>\r\n      </tr>\r\n      ${estimation.materials\r\n        .map(\r\n          (material) => `\r\n        <tr class=\"row11\">\r\n          <td class=\"column2 style7 s\">${material.description}</td>\r\n          <td class=\"column5 style16 f\">${material.uom}</td>\r\n          <td class=\"column3 style8 n\">${material.quantity.toFixed(2)}</td>\r\n          <td class=\"column4 style21 n\">${material.unitPrice.toFixed(2)}</td>\r\n          <td class=\"column5 style16 f\">${material.total.toFixed(2)}</td>\r\n        </tr>\r\n      `\r\n        )\r\n        .join(\"\")}\r\n      <tr class=\"row16\">\r\n        <td class=\"column2 style35 s style37\" colspan=\"4\">TOTAL MATERIALS&nbsp;&nbsp;</td>\r\n        <td class=\"column5 style18 f\">${materialsTotal.toFixed(2)}</td>\r\n      </tr>\r\n      <tr class=\"row17\">\r\n        <td class=\"column1 style43 null style45\" colspan=\"5\"></td>\r\n      </tr>\r\n\r\n      <!-- Labour section -->\r\n      <tr class=\"row18\">\r\n        <td class=\"column1 style15 s\">LABOUR CHARGES</td>\r\n        <td class=\"column2 style9 s\">DESIGNATION</td>\r\n        <td class=\"column3 style22 s\">QTY/DAYS</td>\r\n        <td class=\"column4 style6 s\">PRICE</td>\r\n        <td class=\"column5 style16 s\">TOTAL</td>\r\n      </tr>\r\n      ${estimation.labour\r\n        .map(\r\n          (labour, index) => `\r\n          <tr class=\"row19\">\r\n            ${\r\n              index === 0\r\n                ? `<td class=\"column1 style46 null style48\" rowspan=\"${\r\n                    estimation.labour.length + 1\r\n                  }\"></td>`\r\n                : \"\"\r\n            }\r\n            <td class=\"column2 style7 s\">${labour.designation}</td>\r\n            <td class=\"column3 style21 n\">${labour.days.toFixed(2)}</td>\r\n            <td class=\"column4 style21 n\">${labour.price.toFixed(2)}</td>\r\n            <td class=\"column5 style17 f\">${labour.total.toFixed(2)}</td>\r\n          </tr>\r\n        `\r\n        )\r\n        .join(\"\")}\r\n      <tr class=\"row21\">\r\n        <td class=\"column2 style35 s style37\" colspan=\"3\">TOTAL LABOUR &nbsp;&nbsp;</td>\r\n        <td class=\"column5 style18 f\">${labourTotal.toFixed(2)}</td>\r\n      </tr>\r\n\r\n      <!-- Terms and conditions section -->\r\n      <tr class=\"row18\">\r\n        <td class=\"column1 style15 s\">TERMS AND CONDITIONS</td>\r\n        <td class=\"column2 style9 s\">MISCELLANEOUS CHARGES</td>\r\n        <td class=\"column3 style22 s\">QTY</td>\r\n        <td class=\"column4 style6 s\">PRICE</td>\r\n        <td class=\"column5 style16 s\">TOTAL</td>\r\n      </tr>\r\n      ${estimation.termsAndConditions\r\n        .map(\r\n          (term, index) => `\r\n          <tr class=\"row19\">\r\n            ${\r\n              index === 0\r\n                ? `<td class=\"column1 style34 null\" rowspan=\"${\r\n                    estimation.termsAndConditions.length + 1\r\n                  }\"></td>`\r\n                : \"\"\r\n            }\r\n            <td class=\"column2 style7 s\">${term.description}</td>\r\n            <td class=\"column3 style21 n\">${term.quantity.toFixed(2)}</td>\r\n            <td class=\"column4 style8 n\">${term.unitPrice.toFixed(2)}</td>\r\n            <td class=\"column5 style17 f\">${term.total.toFixed(2)}</td>\r\n          </tr>\r\n        `\r\n        )\r\n        .join(\"\")}\r\n      <tr class=\"row24\">\r\n        <td class=\"column2 style35 s style37\" colspan=\"3\">\r\n          TOTAL MISCELLANEOUS &nbsp;&nbsp;\r\n        </td>\r\n        <td class=\"column5 style18 f\">${termsTotal.toFixed(2)}</td>\r\n      </tr>\r\n\r\n      <!-- Amount summary -->\r\n      <tr class=\"row25\">\r\n        <td class=\"column1 style38 s style40\" colspan=\"4\" style=\"padding-left: 10px;\">\r\n          ESTIMATED AMOUNT\r\n        </td>\r\n        <td class=\"column5 style17 f\">${estimatedAmount.toFixed(2)}</td>\r\n      </tr>\r\n      <tr class=\"row26\">\r\n        <td class=\"column1 style38 s style40\" colspan=\"4\" style=\"padding-left: 10px;\">\r\n          QUOTATION AMOUNT\r\n        </td>\r\n        <td class=\"column5 style33 n\">${\r\n          estimation.quotationAmount?.toFixed(2) || \"0.00\"\r\n        }</td>\r\n      </tr>\r\n      <tr class=\"row27\">\r\n        <td class=\"column1 style57 s style59\" colspan=\"4\" style=\"padding-left: 10px;\">PROFIT</td>\r\n        <td class=\"column5 style20 f\">\r\n          <div style=\"position: relative\">\r\n            <img\r\n              style=\"position: absolute; z-index: 1; left: 12px; top: 28px; width: 96px; height: 102px;\"\r\n              src=\"https://krishnadas-test-1.s3.ap-south-1.amazonaws.com/alghazal/seal.png\"\r\n              border=\"0\"\r\n            />\r\n          </div>\r\n          ${estimation.profit?.toFixed(2) || \"0.00\"}\r\n        </td>\r\n      </tr>\r\n\r\n      <!-- Approval section -->\r\n      <tr class=\"row28\">\r\n        <td class=\"column1 style28 s\">Prepared By: ${\r\n          preparedBy?.firstName || \"N/A\"\r\n        }</td>\r\n        <td class=\"column2 style29 s\">Checked By: ${\r\n          checkedBy?.firstName || \"N/A\"\r\n        }</td>\r\n        <td class=\"column3 style60 s style61\" colspan=\"2\">\r\n          Approved by: ${approvedBy?.firstName || \"N/A\"}\r\n        </td>\r\n        <td class=\"column5 style62 null style63\" rowspan=\"2\"></td>\r\n      </tr>\r\n      <tr class=\"row29\">\r\n        <td class=\"column1 style31 null\" style=\"text-align: center;\">\r\n          <div style=\"display: inline-block;\">\r\n          ${\r\n            preparedBy?.signatureImage\r\n              ? `<img\r\n                style=\"width: 55px; height: 32px;\"\r\n                src=\"${preparedBy.signatureImage}\"\r\n                border=\"0\"\r\n              />`\r\n              : \"\"\r\n          }\r\n          </div>\r\n        </td>\r\n        <td class=\"column2 style30 null\" style=\"text-align: center;\">\r\n          <div style=\"display: inline-block;\">\r\n          ${\r\n            checkedBy?.signatureImage\r\n              ? `<img\r\n                style=\"width: 80px; height: 36px;\"\r\n                src=\"${checkedBy.signatureImage}\"\r\n                border=\"0\"\r\n              />`\r\n              : \"\"\r\n          }\r\n          </div>\r\n        </td>\r\n        <td class=\"column3 style60 null style61\" colspan=\"2\" style=\"text-align: center;\">\r\n          <div style=\"display: inline-block;\">\r\n            ${\r\n              approvedBy?.signatureImage\r\n                ? `<img\r\n                  style=\"width: 87px; height: 42px;\"\r\n                  src=\"${approvedBy.signatureImage}\"\r\n                  border=\"0\"\r\n                />`\r\n                : \"\"\r\n            }\r\n          </div>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</body>\r\n    </html>\r\n  `;\r\n\r\n    // Generate PDF\r\n    const browser = await puppeteer.launch({\r\n      headless: \"shell\",\r\n      args: [\"--no-sandbox\", \"--disable-setuid-sandbox\"],\r\n    });\r\n\r\n    try {\r\n      const page = await browser.newPage();\r\n\r\n      await page.setViewport({\r\n        width: 1200,\r\n        height: 1800,\r\n        deviceScaleFactor: 1,\r\n      });\r\n\r\n      await page.setContent(htmlContent, {\r\n        waitUntil: [\"load\", \"networkidle0\", \"domcontentloaded\"],\r\n        timeout: 30000,\r\n      });\r\n\r\n      // Additional wait for dynamic content\r\n      await page.waitForSelector(\"body\", { timeout: 5000 });\r\n\r\n      const pdfBuffer = await page.pdf({\r\n        format: \"A4\",\r\n        printBackground: true,\r\n        margin: {\r\n          top: \"0.5in\",\r\n          right: \"0.5in\",\r\n          bottom: \"0.5in\",\r\n          left: \"0.5in\",\r\n        },\r\n        preferCSSPageSize: true,\r\n      });\r\n\r\n      res.setHeader(\"Content-Type\", \"application/pdf\");\r\n      res.setHeader(\r\n        \"Content-Disposition\",\r\n        `attachment; filename=estimation-${estimation.estimationNumber}.pdf`\r\n      );\r\n      res.send(pdfBuffer);\r\n    } finally {\r\n      await browser.close();\r\n    }\r\n  }\r\n);\r\n"]}